---
hide_title: true
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

## 一句话

![tu](/img/redux/1.1.svg)

Redux 是 JavaScript 应用的状态容器，帮你管理“全局”状态。  
Redux 体小而精悍， 支持 React 及其它框架使用。

## Redux 术语

![1.2](/img/redux/1.2.png)

从组件中提取共享 state，并将其放入组件树之外的一个集中位置。这样，我们的组件树就变成了一个大“view”，任何组件都可以访问 state 或触发 action，无论它们在树中的哪个位置！

通过定义和分离 state 管理中涉及的概念并强制执行维护 view 和 state 之间独立性的规则，代码变得更结构化和易于维护。

这就是 Redux 背后的基本思想：应用中使用集中式的全局状态来管理，并明确更新状态的模式，以便让代码具有可预测性。

### reducer

reducer 是一个函数，决定如何更新状态。  
接收 state 和一个 action 对象，并返回新状态。

```javascript
const initialState = { msg: "张三" };

function reducer(state = initialState, action) {
  if (action.type === "SET_MSG") {
    // 检查 reducer 是否关心这个 action
    return { ...state, msg: action.payload };
  }
  return state; // 返回原来的 state 不变
}
```

### action

action 是一个具有 type 字段的普通 JavaScript 对象。你可以将 action 视为描述应用程序中发生了什么的事件。    
action 对象可以有其他字段，按照惯例，我们将该信息放在名为 payload 的字段中。  
一个典型的 action 对象可能如下所示：

```javascript
const setMsgAction = {
  type: "SET_MSG",
  payload: "李四",
};
```

### store

store 的对象里存入了当前 Redux 应用的状态，store 里提供了读写状态数据的操作。  
store 是通过传入一个 reducer 来创建的，下边我们来创建一个。

<Tabs>
  <TabItem value="@reduxjs/toolkit" label="@reduxjs/toolkit" default>

```tsx title="/src/store/index.tsx"
import { configureStore } from "@reduxjs/toolkit";

// state
const initialState = {
  msg: "张三",
};

// reducer
const reducer = (state = initialState, action) => {
  switch (action.type) {
    case "SET_MSG":
      return { ...state, ...{ msg: action.payload } };
    default:
      return state;
  }
};

// store
export default configureStore({ reducer });
```

  </TabItem>

  <TabItem value="redux" label="redux">

```tsx title="/src/store/index.tsx"
import { createStore } from "redux";

// state
const initialState = {
  msg: "张三",
};

// reducer
const reducer = (state = initialState, action) => {
  switch (action.type) {
    case "SET_MSG":
      return { ...state, ...{ msg: action.payload } };
    default:
      return state;
  }
};

// store
export default createStore(reducer);
```

  </TabItem>
</Tabs>

**getState**  
获取当前 state 状态值

```javascript title="/src/pages/App.tsx"
import store from "/src/store/index.tsx";
const { msg } = store.getState();
console.log(msg); // 张三
```

**dispatch**  
Redux store 有一个方法叫 dispatch。  
更新 state 的唯一方法是调用 store.dispatch() 并传入一个 action 对象。  
store 将执行所有 reducer 函数并计算出更新后的 state，调用 getState() 可以获取新 state。

```javascript title="/src/components/Tips.tsx"
import store from "/src/store/index.tsx";

store.dispatch({ type: "SET_MSG", payload: "李四" });
const { msg } = store.getState();
console.log(msg); // 李四
```

**subscribe**  
state 变化监听器。每当 dispatch action 的时候就会执行。    
你可以在回调函数里调用 getState() 来拿到当前 state。

```javascript title="/src/pages/App.tsx"
import store from "/src/store/index.tsx";

store.subscribe(() => {
  const { msg } = store.getState();
  console.log(msg); // 李四
});
```


## Redux 数据流
