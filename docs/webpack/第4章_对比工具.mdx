---
title: ç¬¬4ç«  å¯¹æ¯”å…¶å®ƒå·¥å…·
hide_title: true
---
import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";


## rollup

æ¨¡å—æ‰“åŒ…å™¨ï¼Œæ›´å¤šè¯·çœ‹[å®˜ç½‘æ•™ç¨‹](https://www.rollupjs.com)ã€‚  
å’Œ webpack åŠŸèƒ½åŸºæœ¬ä¸€æ ·ï¼Œæ˜¯å…¶ç«å“ã€‚ä¸è¿‡å’Œ webpack çš„åŒºåˆ«åœ¨äºï¼š  
1ã€å®ƒå°å·§ï¼Œä»…æ˜¯æ¬¾ ESM æ‰“åŒ…å™¨ï¼Œæ— å…¶å®ƒåŠŸèƒ½ã€‚  
2ã€å®ƒåˆ©ç”¨ ESM æ”¯æ’‘ï¼Œé webpack ç‰¹æ®Šå¤„ç†ã€‚  
3ã€å®ƒä¸æ”¯æŒæ¨¡å—çš„ HMR çƒ­æ›´æ–°ã€‚

æ‹¿ä¸Šé¢ webpack é‚£ä¸ªä¾‹å­ï¼Œæ”¹ä¸º rollup ç¼–è¯‘

```shell
# rollup å…¥å£æ–‡ä»¶    -d è¾“å‡ºç›®å½•
  rollup .\index.js  -d dist
```

å‘½ä»¤æ‰§è¡Œå®Œæˆåï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ`build`ç›®å½•ï¼Œè¿™é‡Œè¾¹å°±æ˜¯å…¶å¤„ç†å¥½çš„ js æ–‡ä»¶ã€‚æœ€å `index.html` é‡Œå¼•å…¥å³å¯ã€‚

<Tabs>
<TabItem value="index.html" label="index.html">

```html title="index.html"
<button>1+2=?</button>
<script src="./build/index.js"></script>
```

</TabItem>
<TabItem value="index.js" label="index.js">

```js title="build/index.js"
const btn = document.querySelector("button");

btn.onclick = async () => {
  const { add } = await import("./utils-123.js");
  const res = add(1, 2);
  console.log(res);
};
```

</TabItem>
<TabItem value="utils-5c8046dd.js" label="utils-123.js">

```js title="build/utils-123.js"
const add = (x, y) => {
  return x + y;
};

export { add };
```

</TabItem>
</Tabs>

å¯ä»¥çœ‹åˆ°ï¼Œæ‰“åŒ…åçš„ä»£ç å’Œæºç æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚  
ä»£ç çš„æ‰§è¡Œä»ä¾èµ–äºæµè§ˆå™¨æœ¬èº«å¯¹æ¨¡å—åŒ–çš„æ”¯æŒï¼Œæ‰€ä»¥æˆ‘è§‰å¾—å®ƒå¤„ç†äº†ä¸ªå¯‚å¯ ğŸ˜‚ã€‚

ğŸ“£ å¾—å‡ºç»“è®ºï¼Œwebpack å’Œ babel åº”ç”¨åœºæ™¯ä¸åŒï¼š
åº”ç”¨å¼€å‘ç”¨ å‰è€…ï¼Œç±»åº“çš„å¼€å‘åˆ™ç”¨ åè€…

## esbuild
[esbuild](https://esbuild.github.io/)æ¨¡å—æ‰“åŒ…å™¨ï¼ŒåŒäº‹ä¹Ÿå…·å¤‡babelçš„åŠŸèƒ½ã€‚

æ‹¿ä¸Šé¢ webpack é‚£ä¸ªä¾‹å­ï¼Œæ”¹ä¸º esbuild ç¼–è¯‘
--bundle è¡¨ç¤ºéœ€è¦ç¼–è¯‘ï¼Œé»˜è®¤åŸæ ·è¾“å‡º     
--splitting ä»£è¡¨åˆ†å‰²ä»£ç ï¼Œé»˜è®¤ä¸åˆ†å‰²   
--format=esm ä»£è¡¨è¾“å‡ºæ¨¡å—ç±»å‹ï¼Œsplittingä»…æ”¯æŒesm   

```shell
  esbuild ./src/index.js --bundle --outdir=build --splitting --format=esm
```

å‘½ä»¤æ‰§è¡Œå®Œæˆåï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ`build`ç›®å½•ï¼Œè¿™é‡Œè¾¹å°±æ˜¯å…¶å¤„ç†å¥½çš„ js æ–‡ä»¶ã€‚æœ€å `index.html` é‡Œå¼•å…¥å³å¯ã€‚

<Tabs>
<TabItem value="index.html" label="index.html">

```html title="index.html"
<button>1+2=?</button>
<script src="./build/index.js"></script>
```

</TabItem>
<TabItem value="index.js" label="index.js">

```js title="build/index.js"
// src/index.js
var btn = document.querySelector("button");
btn.onclick = async () => {
  const { add } = await import("./utils-YOWK4GEG.js");
  const res = add(1, 2);
  console.log(res);
};
```

</TabItem>
<TabItem value="utils-5c8046dd.js" label="utils-123.js">

```js title="build/utils-123.js"
// src/utils.js
var add = (x, y) => {
  return x + y;
};
export {
  add
};

```

</TabItem>
</Tabs>

å¯ä»¥çœ‹å‡º è·Ÿrollupå¤„ç†æ¨¡å—åŒ–çš„æ–¹å¼ å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼   
ä¸è¿‡å¯ä»¥æ˜æ˜¾çœ‹å‡º esbuildä¸ä½†å¤„ç†äº†æ¨¡å—æ‰“åŒ…ï¼Œå¹¶ä¸”è¿˜å¤„ç†äº†ä»£ç è½¬æ¢ï¼Œè¿™æ˜¯å’Œwebpackä¸rollupçš„æœ€å¤§åŒºåˆ«ã€‚      
å…¶å®æœ¬äººä¸€ç›´è§‰å¾—è¿™æ ·æŒºå¥½ï¼Œè°è§„å®šè¦åˆ†es6è¯­æ³•è½¬æ¢ã€es6æ¨¡å—æ‰“åŒ… é‚£ä¹ˆå¤šæ¦‚å¿µï¼Œç»Ÿç§°ä¸ºes6+ä»£ç å¤„ç†å™¨ä¸å°±è¡Œäº†ï¼




<!-- å‰ç«¯å·¥ç¨‹åŒ–å·¥å…·æ€»ç»“å’Œå¯¹æ¯”
åŒ…ç®¡ç†å·¥å…·
ç»è¿‡éªŒè¯ã€è¾ƒç¨³å®šçš„æ„å»ºå·¥å…·
è¾ƒæ–°çš„æ„å»ºå·¥å…·
è‡ªåŠ¨åŒ–æ„å»ºå·¥å…· -->