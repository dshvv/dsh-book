---
hide_title: true
title: ç¬¬7ç«  å·¥ç¨‹åŒ–å·¥å…·
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import WebpackBuildMain from "!!raw-loader!/src/components/DocsFeTeach/WebpackBuild/main.js";
import WebpackBuilUtils from "!!raw-loader!/src/components/DocsFeTeach/WebpackBuild/utils_js.js";
import CodeBlock from "@theme/CodeBlock";

éšç€å‰ç«¯è¶Šå‘å¤æ‚ï¼Œå·¥ç¨‹åŒ–çš„éœ€æ±‚ä¹Ÿæ—¥ç›Šç´§è¿«ã€‚

éšç€ JavaScript æ–°ç‰ˆï¼ˆes6ï¼‰çš„è¯ç”Ÿï¼Œå¾ˆå¤šæ­¤ç±»æŠ€æœ¯ä¹Ÿå¦‚é›¨åæ˜¥ç¬‹ï¼Œçº·çº·å‡ºç°ï¼

## babel

è¯­æ³•ç¼–è¯‘å·¥å…·ï¼Œ å®ƒèƒ½å°†æ–°ç‰ˆ js ç¼–å†™çš„ä»£ç è½¬æ¢ä¸ºå‘åå…¼å®¹çš„ js è¯­æ³•ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¿è¡Œåœ¨å½“å‰å’Œæ—§ç‰ˆæœ¬çš„æµè§ˆå™¨æˆ–å…¶ä»–ç¯å¢ƒä¸­ã€‚

```js
const i = 123;
```

å¦‚ä¸Šä»£ç  åœ¨å¤è€çš„ ie8 ä¸Šä¼šæŠ¥é”™â€œä¸è¯†åˆ«â€ ï¼  
![fe-teach-7.1](/img/fe-teach/7.1.png)

é‚£å¦‚ä½•è®©è€æµè§ˆå™¨å…¼å®¹è¿™ç§æƒ…å†µå‘¢ï¼Ÿ  
æˆ‘ä»¬æ¥ä½¿ç”¨ babel è½¬è¯‘ï¼  
å¯ä»¥çœ‹åˆ°å³ä¾§ç¼–è¯‘è¿‡åçš„ä»£ç å°±å¯ä»¥è¢« ie è¯†åˆ«çš„  
![fe-teach-7.2](/img/fe-teach/7.2.jpg)

[å®˜ç½‘æ•™ç¨‹](https://www.babeljs.cn)è¿™é‡Œæœ‰æ›´å…·ä½“çš„ç”¨æ³•ã€‚

## webpack

[æ¨¡å—åŒ–æŠ€æœ¯](https://www.cnblogs.com/dingshaohua/p/8371018.html)æ˜¯ 2017 æ‰åœ¨å‰ç«¯ä¸­å…´èµ·ã€‚  
æˆªè‡³ 2021 æµè§ˆå™¨å°šä¸èƒ½å‹å¥½æ”¯æŒæ¨¡å—ï¼Œä¸èƒ½è¯†åˆ«æ¨¡å—åŒ–è¯­æ³•ï¼Œå¦‚ import exportã€‚

å¦‚ä¸‹ä»£ç ï¼Œæµè§ˆå™¨ä¸Šä¼šæŠ¥é”™ã€‚

<Tabs>
<TabItem value="index.html" label="index.html" default>

```html
<div>æˆ‘æ˜¯é¦–é¡µ</div>
<script src="./index.js"></script>
```

</TabItem>
<TabItem value="index.js" label="index.js">

```js title="index.js"
import utils from "./utils";

const res = utils.add(1, 2);
console.log(res);
```

</TabItem>
<TabItem value="utils.js" label="utils.js">

```js title="utils.js"
export default {
  add(x, y) {
    return x + y;
  },
};
```

</TabItem>

</Tabs>

![fe-teach-7.3](/img/fe-teach/7.3.jpg)

ğŸ‘‡ğŸ‘‡ğŸŒ¹ğŸŒºğŸŒ»ğŸŒ¼ğŸŒ¸ğŸ’ğŸ‘‡ğŸ‘‡

äºæ˜¯ï¼Œwebpack ä¸Šåœºäº†ã€‚  
webpack æ˜¯ js æ¨¡å—å¤„ç†çš„å·¥å…·ã€æ¨¡å—æ‰“åŒ…å™¨ã€‚  
å®ƒæ ¹æ®æ¨¡å—çš„ä¾èµ–å…³ç³»è¿›è¡Œåˆ†æï¼Œç„¶åç”Ÿæˆå¯¹åº”çš„é™æ€èµ„æºã€‚

å¦‚ä¸Šä»£ç ï¼Œç”¨ webpack å¤„ç† æµè§ˆå™¨å³å¯è¯†åˆ«ï¼š

```shell
webpack ./index.js --mode=development
```

ä¹‹åï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ`dist/main.js`ã€‚  
index.html å¼•å…¥è¿™ä¸ªæ–‡ä»¶å³å¯æ­£å¸¸ä½¿ç”¨

```html title="index.html"
<div>æˆ‘æ˜¯é¦–é¡µ</div>
<script src="./dist/main.js"></script>
```

![fe-teach-7.4](/img/fe-teach/7.4.jpg)

[å®˜ç½‘æ•™ç¨‹](https://webpack.docschina.org)è¿™é‡Œæœ‰æ›´å…·ä½“çš„ç”¨æ³•ã€‚

## rollup

å’Œ webpack åŠŸèƒ½ä¸€æ ·ï¼Œwebpack çš„ç«å“ã€‚

å’Œ webpack çš„åŒºåˆ«åœ¨äºï¼š  
1ã€å®ƒå°å·§ï¼Œwebpack å¯ç»“åˆæ’ä»¶å¯ä»¥å®Œæˆå‰ç«¯å·¥ç¨‹åŒ–çš„ç»å¤§å¤šæ•°å·¥ä½œï¼Œè€Œ Rollup ä»…ä»…æ˜¯ä¸€æ¬¾ ESM æ‰“åŒ…å™¨ï¼Œæ²¡æœ‰å…¶å®ƒåŠŸèƒ½ã€‚  
2ã€å®ƒåˆ©ç”¨ ESM æ”¯æ’‘ï¼Œé webpack ç‰¹æ®Šå¤„ç†ã€‚  
3ã€å®ƒä¸æ”¯æŒæ¨¡å—çš„ HMR çƒ­æ›´æ–°ã€‚

æ‰€ä»¥å®ƒä»¬æ˜¯æœ‰ä¸åŒçš„åº”ç”¨åœºæ™¯ï¼š
å¯¹äºåº”ç”¨ä½¿ç”¨ webpackï¼Œå¯¹äºç±»åº“ä½¿ç”¨ Rollup

æ‹¿ä¸Šé¢ webpack é‚£ä¸ªä¾‹å­ï¼Œ  
æ”¹ä¸º rollup ç¼–è¯‘

```shell
# rollup å…¥å£æ–‡ä»¶ --file è¾“å‡ºæ–‡ä»¶
rollup ./index.js --file bundle.js
```

### webpack å¤„ç†åˆ†åŒ…

ä¸åˆ†åŒ…çš„æƒ…å†µä¸‹ï¼Œä¸¤è€…è¶‹äºä¸€è‡´ã€‚  
åˆ†åŒ…åˆ™èƒ½ä½“ç°ä¸ webpack çš„å·®åˆ«ã€‚
è¿™æ˜¯æºç 

<Tabs>
<TabItem value="index.html" label="index.html" default>

```html
<button>1+2=?</button>
<script src="./index.js"></script>
```

</TabItem>
<TabItem value="index.js" label="index.js">

```js title="index.js"
const onClick = async () => {
  const { default: utils } = await import("./utils");
  const res = utils.add(1, 2);
  console.log(res);
};
document.querySelector("button").onclick = onClick;
```

</TabItem>
<TabItem value="utils.js" label="utils.js">

```js title="utils.js"
export default {
  add(x, y) {
    return x + y;
  },
};
```

</TabItem>

</Tabs>

ä¸å‡ºæ„å¤–çš„è¯ï¼Œä¸€èˆ¬æµè§ˆå™¨æ˜¯è‚¯å®šä¸èƒ½è¯†åˆ«çš„ã€‚  
æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ webpack æ‰“åŒ…ã€‚

<Tabs>
  <TabItem value="dist/main.js" label="dist/main.js">
    <CodeBlock language="js" title="dist/main.js">
      {WebpackBuildMain}
    </CodeBlock>
  </TabItem>
  <TabItem value="dist/utils_js.js" label="dist/utils_js.js">
    <CodeBlock language="js" title="dist/utils_js.js">
      {WebpackBuilUtils}
    </CodeBlock>
  </TabItem>
</Tabs>

ç„¶åé¡µé¢å¼•å…¥æ‰“åŒ…åçš„æ–‡ä»¶å³å¯

```html
<button>1+2=?</button>
<script src="./dist/main.js"></script>
```

å¯ä»¥çœ‹åˆ° webpack å¯¹åˆ†åŒ…çš„å¤„ç†ï¼Œç‰¹åˆ«çš„å¤æ‚ï¼   
å®Œå…¨è‡ªå·±å®ç°äº†ä¸€å¥—æ¨¡å—åŒ–å¤„ç†æœºåˆ¶ã€‚

### rollup å¤„ç†åˆ†åŒ…

æˆ‘ä»¬ç”¨ rollup å¤„ç†åŒ…å«åˆ†åŒ…çš„ä»£ç   
å¤„ç†åˆ†åŒ…çš„æ—¶å€™ï¼Œæ‰“åŒ…å‘½ä»¤è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹

```shell
# rollup å…¥å£æ–‡ä»¶    -d è¾“å‡ºç›®å½•
  rollup .\index.js  -d dist
```

æ¥çœ‹çœ‹æ‰“åŒ…åçš„å†…å®¹

<Tabs>
<TabItem value="build/index.js" label="build/index.js">

```js title="build/index.js"
const onClick = async () => {
  const { default: utils } = await import("./utils-5c8046dd.js");
  const res = utils.add(1, 2);
  console.log(res);
};
document.querySelector("button").onclick = onClick;
```

</TabItem>
<TabItem value="build/utils-5c8046dd.js" label="build/utils-5c8046dd.js">

```js title="build/utils-5c8046dd.js"
var utils = {
  add(x, y) {
    return x + y;
  }
};
export { utils as default };
```

</TabItem>
</Tabs>

ç„¶åé¡µé¢å¼•å…¥æ‰“åŒ…åçš„æ–‡ä»¶å³å¯

```html
<button>1+2=?</button>
<script src="./build/index.js"></script>
```

å¯ä»¥çœ‹åˆ°ï¼Œæ‰“åŒ…åçš„ä»£ç æä¸ºç®€å•ï¼Œå‡ ä¹å’Œæºç æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚
ä½†æ˜¯è¿™ä¾èµ–äºæµè§ˆå™¨æœ¬èº«å¯¹æ¨¡å—åŒ–çš„æ”¯æŒï¼Œæˆªè‡³2022å¹´ åªæœ‰chromeå¯ä»¥æ”¯æŒã€‚

<!-- å‰ç«¯å·¥ç¨‹åŒ–å·¥å…·æ€»ç»“å’Œå¯¹æ¯”
åŒ…ç®¡ç†å·¥å…·
ç»è¿‡éªŒè¯ã€è¾ƒç¨³å®šçš„æ„å»ºå·¥å…·
è¾ƒæ–°çš„æ„å»ºå·¥å…·
è‡ªåŠ¨åŒ–æ„å»ºå·¥å…· -->